Description: Ensure that libraries are linked against BLAS and LAPACK when needed
 In particular, this ensures that the shared libraries packages have correct
 dependencies.
Author: SÃ©bastien Villemot <sebastien@debian.org>
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=700525
Forwarded: no
Last-Update: 2013-02-27
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/src/cvode/Makefile.in
+++ b/src/cvode/Makefile.in
@@ -42,6 +42,7 @@
 LIBS     = @LIBS@
 
 LAPACK_ENABLED = @LAPACK_ENABLED@
+BLAS_LAPACK_LIBS = @BLAS_LAPACK_LIBS@
 
 top_srcdir = $(srcdir)/../..
 
@@ -88,7 +89,7 @@
 	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(CVODE_LIB) $(CVODE_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
 
 lib_with_bl: shared $(CVODE_LIB_FILES) $(CVODE_BL_LIB_FILES)
-	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(CVODE_LIB) $(CVODE_LIB_FILES)  $(CVODE_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
+	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(CVODE_LIB) $(CVODE_LIB_FILES)  $(CVODE_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) $(BLAS_LAPACK_LIBS) -version-info $(LIB_REVISION)
 
 install: $(CVODE_LIB)
 	$(mkinstalldirs) $(includedir)/cvode
--- a/src/cvodes/Makefile.in
+++ b/src/cvodes/Makefile.in
@@ -42,6 +42,7 @@
 LIBS     = @LIBS@
 
 LAPACK_ENABLED = @LAPACK_ENABLED@
+BLAS_LAPACK_LIBS = @BLAS_LAPACK_LIBS@
 
 top_srcdir = $(srcdir)/../..
 
@@ -88,7 +89,7 @@
 	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(CVODES_LIB) $(CVODES_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
 
 lib_with_bl: shared $(CVODES_LIB_FILES) $(CVODES_BL_LIB_FILES)
-	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(CVODES_LIB) $(CVODES_LIB_FILES) $(CVODES_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
+	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(CVODES_LIB) $(CVODES_LIB_FILES) $(CVODES_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) $(BLAS_LAPACK_LIBS) -version-info $(LIB_REVISION)
 
 install: $(CVODES_LIB)
 	$(mkinstalldirs) $(includedir)/cvodes
--- a/src/ida/Makefile.in
+++ b/src/ida/Makefile.in
@@ -42,6 +42,7 @@
 LIBS     = @LIBS@
 
 LAPACK_ENABLED = @LAPACK_ENABLED@
+BLAS_LAPACK_LIBS = @BLAS_LAPACK_LIBS@
 
 top_srcdir = $(srcdir)/../..
 
@@ -88,7 +89,7 @@
 	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(IDA_LIB) $(IDA_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
 
 lib_with_bl: shared $(IDA_LIB_FILES) $(IDA_BL_LIB_FILES)
-	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(IDA_LIB) $(IDA_LIB_FILES) $(IDA_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
+	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(IDA_LIB) $(IDA_LIB_FILES) $(IDA_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) $(BLAS_LAPACK_LIBS) -version-info $(LIB_REVISION)
 
 install: $(IDA_LIB)
 	$(mkinstalldirs) $(includedir)/ida
--- a/src/idas/Makefile.in
+++ b/src/idas/Makefile.in
@@ -42,6 +42,7 @@
 LIBS     = @LIBS@
 
 LAPACK_ENABLED = @LAPACK_ENABLED@
+BLAS_LAPACK_LIBS = @BLAS_LAPACK_LIBS@
 
 top_srcdir = $(srcdir)/../..
 
@@ -88,7 +89,7 @@
 	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(IDAS_LIB) $(IDAS_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
 
 lib_with_bl: shared $(IDAS_LIB_FILES) $(IDAS_BL_LIB_FILES)
-	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(IDAS_LIB) $(IDAS_LIB_FILES) $(IDAS_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
+	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(IDAS_LIB) $(IDAS_LIB_FILES) $(IDAS_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) $(BLAS_LAPACK_LIBS) -version-info $(LIB_REVISION)
 
 install: $(IDAS_LIB)
 	$(mkinstalldirs) $(includedir)/idas
--- a/src/kinsol/Makefile.in
+++ b/src/kinsol/Makefile.in
@@ -42,6 +42,7 @@
 LIBS     = @LIBS@
 
 LAPACK_ENABLED = @LAPACK_ENABLED@
+BLAS_LAPACK_LIBS = @BLAS_LAPACK_LIBS@
 
 top_srcdir = $(srcdir)/../..
 
@@ -88,7 +89,7 @@
 	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(KINSOL_LIB) $(KINSOL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
 
 lib_with_bl: shared $(KINSOL_LIB_FILES) $(KINSOL_BL_LIB_FILES)
-	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(KINSOL_LIB) $(KINSOL_LIB_FILES) $(KINSOL_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) -version-info $(LIB_REVISION)
+	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) -o $(KINSOL_LIB) $(KINSOL_LIB_FILES) $(KINSOL_BL_LIB_FILES) $(SHARED_LIB_FILES) -rpath $(libdir) $(LDFLAGS) $(LIBS) $(BLAS_LAPACK_LIBS) -version-info $(LIB_REVISION)
 
 install: $(KINSOL_LIB)
 	$(mkinstalldirs) $(includedir)/kinsol
