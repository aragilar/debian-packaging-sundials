#!/usr/bin/make -f
# -*- makefile -*-

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/autotools.mk
include /usr/share/cdbs/1/rules/simple-patchsys.mk

debusr := $(DEB_DESTDIR)usr

DEB_CONFIGURE_EXTRA_FLAGS := --enable-shared --disable-mpi --disable-examples
DEB_MAKE_INSTALL_TARGET := install prefix=$(debusr)

# The following hack is necessary because the upstream makefiles do
# not install $libdir and $includedir
common-install-prehook-impl::
	mkdir -p $(debusr)/lib
	mkdir -p $(debusr)/include	

# The followiung hack is necessary because there is no way to prevent
# the -rpath otpion being used during make install
install/libsundials-serial0::
	perl -pi -e "s:libdir='.*':libdir='/usr/lib':;" \
		`find debian/ -name \*.la`

clean::
	rm -rf `find . -name .libs -o -name \*.o` libtool
